machine:
  node:
    version: v6.1.0
  environment:
    PORT: 10010
    POSTGRES_HOST: 127.0.0.1
    POSTGRES_DB: circle_test
    POSTGRES_USER: ubuntu

dependencies:
  override:
    - npm install -q && npm cache clean

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - ./node_modules/.bin/gulp lint
    - ./node_modules/.bin/gulp test:setup
    - ./node_modules/.bin/nyc ./node_modules/.bin/ava --tap | ./node_modules/.bin/tap-xunit > $CIRCLE_TEST_REPORTS/junit/test-results.xml
